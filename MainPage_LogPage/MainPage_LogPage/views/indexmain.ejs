<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
    <link rel='stylesheet' href='/stylesheets/styleMain.css' />
  </head>
  <body>

    <div class="topnav">
      <h1 id="toptxt">Camera</h1>
      <button id="setting" onclick="window.location.href='/setting'">
        <i class="fa-solid fa-gear"></i>
      </button>
    </div>

    <div id="Camera" class="container">
      <div class="content">
        
        <img id="canvas" width="640" height="480" src="http://192.168.1.158:81/stream">
        

      </div>

      <div class="controls">
        <button id="CallBtn"> 
          <i class="fa-solid fa-phone-volume"></i>
        </button>
      </div>

      <div class="LockUnlock">
        <button id="LockBtn" onclick="sendCommand('/0')" >
          <i class="fa-solid fa-lock"></i>
        </button>

        <button id="unlockBtn" onclick="sendCommand('/90')" >
          <i class="fa-solid fa-lock-open"></i>
        </button>
      </div>

      <div class="StatusBtn">
        <button id="StatusBtn" onclick="window.location.href='/Status'">
          Status
        </button>
      </div>

      <div class="ClosePage">
        <button id="CloseBtn" onclick="window.location.href='/login'">
          <i>Log out</i>
        </button>
      </div>
    </div>

    <script>
      const buttons = document.querySelectorAll('.LockUnlock button');
      buttons.forEach(btn => {
        btn.addEventListener('click', () => {
          buttons.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
        });
      });
      document.getElementById('LockBtn').classList.add('active');
    </script>
    <script>
        const ESP32_IP = "http://192.168.1.172"; 
        function sendCommand(path) {
            const fullUrl = ESP32_IP + path;
            
            // 1. Send the request in the background
            fetch(fullUrl)
                .then(response => {
                    // 2. Check if the ESP32 responded OK (status 200)
                    if (response.ok) {
                        console.log("Command sent: " + path);
                        // You can optionally update a status message here
                    } else {
                        console.error("Error response from ESP32:", response.status);
                    }
                })
                .catch(error => {
                    // 3. Handle network errors
                    console.error("Network error:", error);
                });
        }
    </script>
  </body>

</html>
